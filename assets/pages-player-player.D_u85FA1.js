import{C as a,r as l,D as s,o as e,c as n,w as o,a as c,g as t,t as u,k as r,i,E as d,G as p,H as v,b as g,p as y,F as m}from"./index-BvdOQWNb.js";import{o as _}from"./uni-app.es.eY0CmaXt.js";import{s as f}from"./index.B24DO3sP.js";import{_ as h}from"./plugin-vueexport-helper.BCo6x5W8.js";const P=a("music",(()=>({curMusic:l(null),curMusicSrc:l("")}))),b=h({__name:"PlayBtns",props:["songId"],emits:["changePlay"],setup(a,{emit:p}){const v=P(),g=p,y=a,m=s(),h=l(0),b=l(0),x=l("00:00"),I=l(""),C=l(!1);setTimeout((()=>{(async()=>{var a,l;console.log(y.songId);const s=await f(y.songId);console.log(s),m.src=null==(a=s.data)?void 0:a.data[0].url,v.curMusicSrc=null==(l=s.data)?void 0:l.data[0].url})()})),_((()=>{console.log(1111),m.destroy()}));const M=a=>`${j(parseInt(a/60))}:${j(Math.round(a%60))}`,j=a=>a>=10?a:"0"+a;m.autoplay=!0;const k=a=>{m.currentTime=a.detail.value/100*m.duration},T=()=>{if(m.paused)return m.play(),g("changePlay",!0),void(C.value=!1);m.pause(),g("changePlay",!1),C.value=!0};return m.onCanplay((()=>{g("changePlay",!0),b.value=m.duration,I.value=M(b.value)})),m.onPlay((()=>{console.log("开始播放")})),m.onPause((()=>{console.log("暂停播放")})),m.onTimeUpdate((()=>{h.value=m.duration?m.currentTime/m.duration*100:0,x.value=M(h.value)})),m.onError((a=>{console.log(a.errMsg),console.log(a.errCode)})),(a,l)=>{const s=i,p=d;return e(),n(s,{class:"btns"},{default:o((()=>[c(s,{class:"top"},{default:o((()=>[c(s,{class:"icon icon-heart"}),c(s,{class:"icon icon-gossip"})])),_:1}),c(s,{class:"btnBar"},{default:o((()=>[c(s,{class:"start"},{default:o((()=>[t(u(x.value),1)])),_:1}),c(s,{class:"bar"},{default:o((()=>[c(p,{value:h.value,min:"0",max:b.value,onChanging:k},null,8,["value","max"])])),_:1}),c(s,{class:"end"},{default:o((()=>[t(u(I.value),1)])),_:1})])),_:1}),c(s,{class:"tool"},{default:o((()=>[c(s,{class:"icon icon-type"}),c(s,{class:"icon icon-prev"}),c(s,{class:r(["icon icon-play",{"icon-pause":C.value}]),onClick:T},null,8,["class"]),c(s,{class:"icon icon-next"}),c(s,{class:"icon icon-list"})])),_:1})])),_:1})}}},[["__scopeId","data-v-83dd8f3d"]]),x=h({__name:"player",setup(a){const s=P();p((()=>{v().proxy.getOpenerEventChannel().on("acceptDataFromOpenerPage",(function(a){console.log("Received data in Player:",a),n.value=a,s.curMusic=a,t.value=a.data.al?a.data.al.picUrl:a.data.picUrl,u.value=a.data.id}))}));const n=l(null),t=l(""),u=l(""),d=l(!0),_=a=>{d.value=a};return(a,l)=>{const s=i;return e(),g(m,null,[c(s,{class:"bg",style:y({background:`url(${t.value}) center`})},null,8,["style"]),c(s,{class:"player"},{default:o((()=>[c(s,{class:r(["player-song-bg",{"player-rotate":d.value}])},{default:o((()=>[c(s,{class:"player-song",style:y({background:`url(${t.value}) center`})},null,8,["style"])])),_:1},8,["class"]),c(b,{onChangePlay:_,songId:u.value},null,8,["songId"])])),_:1})],64)}}},[["__scopeId","data-v-40ed1605"]]);export{x as default};
