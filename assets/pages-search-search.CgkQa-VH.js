import{y as e,z as t,s as a,o as l,c as s,w as o,a as n,p as i,A as c,g as r,t as u,u as d,i as h,I as p,j as y,k as f,r as m,b as g,F as _,d as v,B as b,n as k}from"./index-CP19PT5u.js";import{_ as S}from"./uni-icons.BSKKDR_Q.js";import{r as x}from"./uni-app.es._AGFaicw.js";import{_ as C}from"./plugin-vueexport-helper.BCo6x5W8.js";import{q as V,r as w}from"./index.Cx3jpoZy.js";const T={en:{"uni-search-bar.cancel":"cancel","uni-search-bar.placeholder":"Search enter content"},"zh-Hans":{"uni-search-bar.cancel":"取消","uni-search-bar.placeholder":"请输入搜索内容"},"zh-Hant":{"uni-search-bar.cancel":"取消","uni-search-bar.placeholder":"請輸入搜索內容"}},{t:F}=e(T);const $=C({name:"UniSearchBar",emits:["input","update:modelValue","clear","cancel","confirm","blur","focus"],props:{placeholder:{type:String,default:""},radius:{type:[Number,String],default:5},clearButton:{type:String,default:"auto"},cancelButton:{type:String,default:"auto"},cancelText:{type:String,default:""},bgColor:{type:String,default:"#F8F8F8"},textColor:{type:String,default:"#000000"},maxlength:{type:[Number,String],default:100},value:{type:[Number,String],default:""},modelValue:{type:[Number,String],default:""},focus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},data:()=>({show:!1,showSync:!1,searchVal:""}),computed:{cancelTextI18n(){return this.cancelText||F("uni-search-bar.cancel")},placeholderText(){return this.placeholder||F("uni-search-bar.placeholder")}},watch:{modelValue:{immediate:!0,handler(e){this.searchVal=e,e&&(this.show=!0)}},focus:{immediate:!0,handler(e){if(e){if(this.readonly)return;this.show=!0,this.$nextTick((()=>{this.showSync=!0}))}}},searchVal(e,t){this.$emit("input",e),this.$emit("update:modelValue",e)}},methods:{searchClick(){this.readonly||this.show||(this.show=!0,this.$nextTick((()=>{this.showSync=!0})))},clear(){this.searchVal="",this.$nextTick((()=>{this.$emit("clear",{value:""})}))},cancel(){this.readonly||(this.$emit("cancel",{value:this.searchVal}),this.searchVal="",this.show=!1,this.showSync=!1,t())},confirm(){t(),this.$emit("confirm",{value:this.searchVal})},blur(){t(),this.$emit("blur",{value:this.searchVal})},emitFocus(e){this.$emit("focus",e.detail)}}},[["render",function(e,t,f,m,g,_){const v=x(a("uni-icons"),S),b=h,k=p,C=y;return l(),s(b,{class:"uni-searchbar"},{default:o((()=>[n(b,{style:i({borderRadius:f.radius+"px",backgroundColor:f.bgColor}),class:"uni-searchbar__box",onClick:_.searchClick},{default:o((()=>[n(b,{class:"uni-searchbar__box-icon-search"},{default:o((()=>[c(e.$slots,"searchIcon",{},(()=>[n(v,{color:"#c0c4cc",size:"18",type:"search"})]),!0)])),_:3}),g.show||g.searchVal?(l(),s(k,{key:0,focus:g.showSync,disabled:f.readonly,placeholder:_.placeholderText,maxlength:f.maxlength,class:"uni-searchbar__box-search-input","confirm-type":"search",type:"text",modelValue:g.searchVal,"onUpdate:modelValue":t[0]||(t[0]=e=>g.searchVal=e),style:i({color:f.textColor}),onConfirm:_.confirm,onBlur:_.blur,onFocus:_.emitFocus},null,8,["focus","disabled","placeholder","maxlength","modelValue","style","onConfirm","onBlur","onFocus"])):(l(),s(C,{key:1,class:"uni-searchbar__text-placeholder"},{default:o((()=>[r(u(f.placeholder),1)])),_:1})),g.show&&("always"===f.clearButton||"auto"===f.clearButton&&""!==g.searchVal)&&!f.readonly?(l(),s(b,{key:2,class:"uni-searchbar__box-icon-clear",onClick:_.clear},{default:o((()=>[c(e.$slots,"clearIcon",{},(()=>[n(v,{color:"#c0c4cc",size:"20",type:"clear"})]),!0)])),_:3},8,["onClick"])):d("",!0)])),_:3},8,["style","onClick"]),"always"===f.cancelButton||g.show&&"auto"===f.cancelButton?(l(),s(C,{key:0,onClick:_.cancel,class:"uni-searchbar__cancel"},{default:o((()=>[r(u(_.cancelTextI18n),1)])),_:1},8,["onClick"])):d("",!0)])),_:3})}],["__scopeId","data-v-206a2f37"]]);const z=C({name:"UniSection",emits:["click"],props:{type:{type:String,default:""},title:{type:String,required:!0,default:""},titleFontSize:{type:String,default:"14px"},titleColor:{type:String,default:"#333"},subTitle:{type:String,default:""},subTitleFontSize:{type:String,default:"12px"},subTitleColor:{type:String,default:"#999"},padding:{type:[Boolean,String],default:!1}},computed:{_padding(){return"string"==typeof this.padding?this.padding:this.padding?"10px":""}},watch:{title(e){uni.report&&""!==e&&uni.report("title",e)}},methods:{onClick(){this.$emit("click")}}},[["render",function(e,t,a,p,m,g){const _=h,v=y;return l(),s(_,{class:"uni-section"},{default:o((()=>[n(_,{class:"uni-section-header",onClick:g.onClick},{default:o((()=>[a.type?(l(),s(_,{key:0,class:f(["uni-section-header__decoration",a.type])},null,8,["class"])):c(e.$slots,"decoration",{key:1},void 0,!0),n(_,{class:"uni-section-header__content"},{default:o((()=>[n(v,{style:i({"font-size":a.titleFontSize,color:a.titleColor}),class:f(["uni-section__content-title",{distraction:!a.subTitle}])},{default:o((()=>[r(u(a.title),1)])),_:1},8,["style","class"]),a.subTitle?(l(),s(v,{key:0,style:i({"font-size":a.subTitleFontSize,color:a.subTitleColor}),class:"uni-section-header__content-sub"},{default:o((()=>[r(u(a.subTitle),1)])),_:1},8,["style"])):d("",!0)])),_:1}),n(_,{class:"uni-section-header__slot-right"},{default:o((()=>[c(e.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["onClick"]),n(_,{class:"uni-section-content",style:i({padding:g._padding})},{default:o((()=>[c(e.$slots,"default",{},void 0,!0)])),_:3},8,["style"])])),_:3})}],["__scopeId","data-v-b442413a"]]),B=C({__name:"search",setup(e){const t=m(""),c=m([]),p=m(JSON.parse(localStorage.getItem("history"))||[]),f=m(!0),C=m(!1),T=m([]),F=()=>{0!==p.value.length&&p.value[0]===t.value||p.value.unshift(t.value),p.value=p.value.filter(((e,t,a)=>t===a.indexOf(e))),localStorage.setItem("history",JSON.stringify(p.value)),console.log(p.value)},B=()=>{f.value=!0,C.value=!1,t.value="",c.value=[]},I=()=>{p.value=[],localStorage.getItem("history")&&localStorage.removeItem("history")},j=e=>{C.value=!0,t.value=e,""!==t.value?(console.log("搜索输入"),F(),(async e=>{if(console.log(e),!C.value)return;f.value=!1;const t=await w(e);b((()=>{var e,a;console.log(null==(e=t.data.result)?void 0:e.songs),c.value=null==(a=t.data.result)?void 0:a.songs}))})(e)):console.log(t.value)};return(async e=>{const t=await V();b((()=>{T.value=t.data.result.hots,console.log(t.data)}))})(),(e,m)=>{const b=x(a("uni-search-bar"),$),C=x(a("uni-section"),z),V=y,w=h,N=x(a("uni-icons"),S);return l(),g(_,null,[n(C,null,{default:o((()=>[n(b,{modelValue:t.value,"onUpdate:modelValue":m[0]||(m[0]=e=>t.value=e),modelModifiers:{trim:!0},onInput:j,onConfirm:F,placeholder:"请输入歌手或歌曲名",onCancel:B},null,8,["modelValue"])])),_:1}),f.value?d("",!0):(l(!0),g(_,{key:0},v(c.value,((e,t)=>(l(),s(w,{class:"search-item",style:i({animationDelay:.1*t+"s"}),key:t,onClick:t=>{return a=e,console.log(a),k({url:"/pages/player/player",events:{acceptDataFromOpenedPage:function(e){console.log(e)},someEvent:function(e){console.log(e)}},success:function(e){e.eventChannel.emit("acceptDataFromOpenerPage",{data:a})}}),void F();var a}},{default:o((()=>[n(V,{class:"search-item-title"},{default:o((()=>[r(u(e.name),1)])),_:2},1024)])),_:2},1032,["style","onClick"])))),128)),f.value?(l(),s(C,{key:1,class:"mb-10",title:"搜索历史",type:"line",titleFontSize:"30rpx"},{right:o((()=>[n(N,{type:"trash",size:"60rpx",onClick:I})])),default:o((()=>[n(w,{class:"history"},{default:o((()=>[(l(!0),g(_,null,v(p.value,((e,t)=>(l(),s(w,{class:"history-item",onClick:t=>j(e),key:t},{default:o((()=>[r(u(e),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):d("",!0),f.value?(l(),s(C,{key:2,class:"mb-10",title:"热门搜索",type:"line",titleFontSize:"30rpx"},{default:o((()=>[(l(!0),g(_,null,v(T.value,((e,t)=>(l(),s(w,{class:"hotHistory",key:t,onClick:t=>j(e.first)},{default:o((()=>[r(u(t+1)+" "+u(e.first),1)])),_:2},1032,["onClick"])))),128))])),_:1})):d("",!0)],64)}}},[["__scopeId","data-v-d7d3b2a3"]]);export{B as default};
